//O(N^2M)#include <iostream>#include <vector>#include <cmath>#define rep(i,n) for(int i=0;i<n;i++)using namespace std;typedef vector<int> vi;typedef vector<vi> mat;int MAX_M=;int extgcd(int a,int b,int &x,int &y){	if(b==0){		x=a,y=0;		return a;	}	int d=extgcd(b,a%b,x,y),xx=y,yy=x-a/b*y;	x=xx,y=yy;	return d;}int inv(int a){	int x,y;	extgcd(a,mod,x,y);	return x;}int rank(int eq, int var, mat a, vi b, int p){	int ans=0;	bool used[MAX_eq]={};	rep(j,var){		int i=0;		while( (i < eq) && (used[i] || (a[i][j] == 0) ) ) i++;		if(i == eq) continue;		ans++;		used[i] = true;		rep(k,eq) if(!used[k]){			int coef = (-a[k][j]*inv(a[i][j])%mod+mod)%mod;			rep(l,var) a[k][l] = (a[k][l] + a[i][l] * coef) % p;			b[k] = (b[k] + b[i] * coef) % p;		}	}	rep(i,eq){		if(!used[i] && b[i] != 0) {			return -1;		}	}	return ans;}